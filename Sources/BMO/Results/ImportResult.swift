/*
 * ImportResult.swift
 * BMO
 *
 * Created by François Lamboley on 1/24/18.
 * Copyright © 2018 happn. All rights reserved.
 */

import Foundation



public struct ImportResult<DbType : Db> {
	
	/* Note: We deliberately chose not to put the relationship metadata info from
	 * the bridge in this struct. We could have, but it would have made many
	 * other objects required to be generic and in overall complexified the code.
	 * Furthermore, the bridge metadata info do not really have a place here
	 * anyway.
	 *
	 * If we one day absolutely **do** need the metadata directly in the fast
	 * import results, it is however possible to do so. It would be of good taste
	 * to name the type of these Metadata “UserInfo” as is in the
	 * FastImportRepresentation. */
	
	/** The imported objects directly corresponding to the given db
	representations in the request.
	
	Some importers might decide to drop the relationships part of the result for
	performance reasons (hence the optionality of the relationships part of the
	tuple). */
	public let rootObjectsAndRelationships: [(object: DbType.ObjectType, relationships: [String: ImportResult<DbType>]?)]
	
	/** Contains the changes reported by the db import method. Most of the time
	will only contain modifications generated by the method, not the implicit
	modifications (eg. when a relationship value is replaced, all objects
	previously in the relationship are usually modified because the reverse
	relationship will be set to nil).
	
	Some importers might decide to drop this result for performance reasons,
	hence the optionality. */
	public let changes: ChangesDescription<DbType.ObjectIDType>?
	
}
